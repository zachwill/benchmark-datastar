<!doctype html>
<html>

<head>
  <script type="module" src="https://cdn.jsdelivr.net/gh/starfederation/datastar@main/bundles/datastar.js"></script>
  <script type="module">
    import { benchmark } from "./common.js";

    let currentStartTime = null;

    document.addEventListener('datastar-fetch', (event) => {
      // Fetch "started" normally has earlier evt.timeStamp than clicked event
      if (event.detail.type === 'started') {
        currentStartTime = event.timeStamp;
      } else if (event.detail.type === 'finished') {
        const result = benchmark("datastar-replace", currentStartTime, event.timeStamp);
        currentStartTime = null;
      }
    });
  </script>
</head>

<body>
  <button id="small" data-on-click="@get(`/snippet-replace/small?bust=${Math.random()}`)">
    Run small
  </button>
  <button id="big" data-on-click="@get(`/snippet-replace/big?bust=${Math.random()}`)">
    Run big
  </button>

  <div id="target"></div>
</body>

</html>